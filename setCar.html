<? 
include "inc_html/header.html";
?>

<script>
$(function() {
	$("#setDate").datepicker({
		dateFormat: 'yy-mm-dd',
		prevText: '이전 달',
		nextText: '다음 달',
		monthNames: ['1월','2월','3월','4월','5월','6월','7월','8월','9월','10월','11월','12월'],
		monthNamesShort: ['1월','2월','3월','4월','5월','6월','7월','8월','9월','10월','11월','12월'],
		dayNames: ['일','월','화','수','목','금','토'],
		dayNamesShort: ['일','월','화','수','목','금','토'],
		dayNamesMin: ['일','월','화','수','목','금','토'],
		yearSuffix: ' / ',
		changeMonth : true,
		changeYear : true,
		minDate : 0
	});
});
</script>
<style>
.cardTab { padding:0; border-bottom:1px solid #dfdfdf; font-size:0; text-align:center;}
.cardTab a { display:inline-block; padding:32px; color:#737373; font-size:14px;}
.cardTab a:focus { color:#000; background:#fafafa; font-weight:600;}
.cardTab .active { color:#000; padding:32px 32px 29px 32px; border-bottom:3px solid #d5610a; font-weight:600;}
.cardTab .done { background:#eee;}
.cardTab .badge { background:#777;}
.cardTab .active .badge { background:#e06732;}
.cardTab .done .badge { background:#ccc;}
.cardTab a:active { background:#ececec;}
.cardCont .done { background:#eee;}
.stepCont { height:170px; padding:70px 0; border-left:1px solid #eee;}
.stepCont:first-child { border-left:none;}
.stepCont .loadingText, .stepCont .afterText { display:none;}
.done .beforeText, .done .loadingText, .load .beforeText, .done .loadingText, .yet .loadingText, .yet .afterText { display:none;}
.yet .beforeText, .load .loadingText, .done .afterText { display:block;}

.demo-wrapper {
margin: 20px auto 0;
}
.html5-progress-bar {
padding: 15px 0;
border-radius: 3px;
background-color: #fff;
}
.html5-progress-bar progress {
background-color: #f3f3f3;
border: 0;
width: 100%;
height: 18px;
border-radius: 2px;
}
.html5-progress-bar progress::-webkit-progress-bar {
background-color: #f3f3f3;
border-radius: 2px;
}
.html5-progress-bar progress::-webkit-progress-value {
background: #e06732;
border-radius: 2px;
}
.html5-progress-bar progress::-moz-progress-bar {
background: #e06732;
border-radius: 2px;
}
.html5-progress-bar .progress-value {
padding: 0px 5px;
line-height: 20px;
margin-left: 5px;
font-size: .8em;
color: #555;
height: 18px;
float: right;
}
</style>
<div class="row" style="max-width:1200px; margin:20px auto;">
	<div class="col-md-12">
		<div class="card">
			<div class="cardTitle">
				<span class="titCard">
					초기 배차 설정
				</span>
			</div>
			<div class="cardTab">
				<div class="row" style="margin:0;">
					<a href="javascript:;" class="col-xs-12 active"><span class="badge" style="margin-right:8px;">1</span>배차 일시 정보</a>
				</div>
			</div>
			<div class="cardCont" style="padding:0;">
				<div class="col-xs-12 stepCont text-center">
					<input type="hidden" name="setTime" id="setTime" value="" />
					<div class="beforeText">
						<input type="text" name="setDate" id="setDate" class="input" value="" style="width:150px" placeholder="배차 일시 선택" readonly />
						<div class="btn-group">
							<button type="button" data-toggle="dropdown" class="btn dropdown-toggle btn-sm btn-new-ok" style="width:100px;" name="select-time" aria-expanded="false">오전/오후 선택 <span class="caret"></span></button>
							<ul role="menu" class="dropdown-menu">
								<li><a href="javascript:;">오전</a></li>
								<li><a href="javascript:;">오후</a></li>
							</ul>
						</div>
					</div>
					<div class="loadingText">
						배차 일시를 업데이트 중입니다.
					</div>
					<div class="afterText">
						2017년 9월 11일 06:04 2017년 10월 22일 오전 배차 실행
					</div>
					
					<script>
					$(".dropdown-toggle").parent(".btn-group").find("li").on("click", function(e){
						var target = $(e.currentTarget);
						var idx = target.index();
						var thisValue = $(this).find("a").text();
						var obj = $(this).parent("ul").prev("button").attr("name");
						$("#setTime").val(thisValue);
						$(".dropdown-toggle[name=" + obj + "]").html(thisValue + " <span class='caret'></span>");
					});
					</script>
				</div>
			</div>
			<div class="cardTab" style="border-top:1px solid #dfdfdf">
				<div class="row" style="margin:0;">
					<a href="javascript:;" class="col-xs-6"><span class="badge" style="margin-right:8px;">2</span>고객 정보</a>
					<a href="javascript:;" class="col-xs-6"><span class="badge" style="margin-right:8px;">3</span>배송지 좌표 정보</a>
				</div>
			</div>
			<div class="cardCont" style="padding:0;">
				<div class="col-xs-6 stepCont text-center">
					<div class="beforeText">
						고객 정보 업데이트 전입니다.
					</div>
					<div class="loadingText">
						고객 정보 업데이트 중입니다.
					</div>
					<div class="afterText">
						2017년 10월 22일 06:04 고객정보 업데이트
					</div>
				</div>
				<div class="col-xs-6 stepCont text-center">
					<div class="beforeText">
						배송지 좌표 업데이트 전입니다.
					</div>
					<div class="loadingText">
						배송지 좌표 업데이트 중입니다.
					</div>
					<div class="afterText">
						2017년 10월 22일 06:08 배송지 좌표 업데이트
					</div>
				</div>
			</div>
			<div class="cardTab" style="border-top:1px solid #dfdfdf">
				<div class="row" style="margin:0;">
					<a href="javascript:;" class="col-xs-12"><span class="badge" style="margin-right:8px;">4</span>배송 차량 정보</a>
				</div>
			</div>
			<div class="cardCont" style="padding:0;">
				<div class="col-xs-12 stepCont text-center">
					<div class="beforeText">
						<input type="text" name="setNum" id="setNum" class="input" placeholder="차량 배차 대수 입력" readonly />
					</div>
					<div class="loadingText">
						22대의 배송 경로를 배차 중입니다.
					</div>
					<div class="afterText">
						2017년 10월 22일 오전 22개 경로 배차 실행
					</div>
				</div>
				<div class="col-xs-12 text-right" style="padding:10px 20px; border-top:1px solid #eee;">
					<a href="javascript:;" class="btn btn-lg btn-new-cancle btn-prev-step">이전</a>
					<a href="javascript:;" class="btn btn-lg btn-new-ok btn-next-step">다음</a>
				</div>
			</div>
		</div>
	</div>
	<?
	$nowStep = 0;
	?>
	
	<script>
	// 스텝
	var nowStep = 0;
	var nowAct;
	$(document).ready(function(){
		changElm(parseInt(nowStep/2, nowStep%2));
	});
	function loadModal() {
		if(nowStep != 1) {
			$("#loading").modal({
				backdrop	:	"static"
			});
			
			var progressbar,
				max = 100,
				time = 50,
				value = 0;

			var loading = function() {
				value ++;

				if (value == max) {
					clearInterval(animate);
					$("#loading").modal("hide");

					// 전송중 element 변경
					nowStep++;
					changElm(parseInt(nowStep/2), parseInt(nowStep%2));
				}
			};

			var animate = setInterval(function() {
				loading();
			}, time);

		} else {
			
			nowStep++;
			changElm(parseInt(nowStep/2), parseInt(nowStep%2));
		}
		//changElm(parseInt(nowStep/2), parseInt(nowStep%2));
	}

	function changElm(step, changeText) {
		$(".cardTab a").removeClass("active");
		$(".cardTab a").eq(step).addClass("active");

		$(".cardTab a").each(function(e){
			if(e<step) {
				$(this).addClass("done");
				$(".stepCont").eq(e).removeClass("load yet").addClass("done");
			} else {
				$(this).removeClass("done");
				$(".stepCont").eq(e).removeClass("done load").addClass("yet");
			}
			//if(e == step) $(this).prev("a").remoteClass("active");
		});

		//alert(step + "+" + changeText);

		if(changeText == 1) {
			$(".stepCont").eq(step).removeClass("yet").addClass("load");
			//loadModal();
		}

		if(step == 0) {
			$("#setNum").prop("readOnly", true);
			$(".btn-prev-step").removeAttr("disabled");
			$(".btn-prev-step").attr("disabled", "disabled");
		} else if(step == 1) {
			$("#setNum").prop("readOnly", true);
			$(".btn-prev-step").removeAttr("disabled");
			$(".btn-next-step").text("다음").attr("href", "javascript:;");
		} else if(step == 2) {
			$("#setNum").prop("readOnly", true);
			$(".btn-prev-step").removeAttr("disabled");
			$(".btn-next-step").text("다음").attr("href", "javascript:;");
		} else if(step == 3) {
			$("#setNum").removeAttr("readOnly");
			$(".btn-prev-step").removeAttr("disabled");
			$(".btn-next-step").text("다음").attr("href", "javascript:;");
		} else if(step == 4) {
			$("#setNum").prop("readOnly", true);
			$(".btn-prev-step").removeAttr("disabled");
			$(".btn-next-step").text("배차 시작").attr("href", "javascript:;");
		} else if(step == 5) {
			$("#setNum").prop("readOnly", true);
			$(".btn-prev-step").removeAttr("disabled");
			$(".btn-next-step").text("배차 시작").attr("href", "setCarList.html");
		}
	}

	$(".btn-next-step").on("click", function(){
		nowAct = "+";
		$(this).blur();

		if(parseInt(nowStep/2) < 5) {
			nowStep++;
			//alert(parseInt(nowStep/3));
			changElm(parseInt(nowStep/2), parseInt(nowStep%2));
		}
	});
	$(".btn-prev-step").on("click", function(){
		nowAct = "-";
		$(this).blur();

		if(nowStep > 0) {
			nowStep-=2;
			
			changElm(parseInt(nowStep/2), parseInt(nowStep%2));
		}
	});
	// 높이 맞추기
	var matchH;
	var matchHresize;
	$(".matchHeight").each(function(){
		var thisHeight = $(this).outerHeight();
		if (matchH){
			if(thisHeight > matchH){
				matchH = thisHeight;
			}
		} else {
			matchH = thisHeight;
		}
	});
	$(window).load(function(){
		var windowH = $(window).outerHeight();
		var headerH = $("#header").outerHeight();
		var copyH = $(".copy").outerHeight();
		var contH = windowH - ( headerH + copyH );
		//alert($("#lnb").outerHeight());
		if($("body").hasClass("pc")) {
			$("#map").height(contH - 235);
			$(".setCarList").height(contH - 505);
		}
	});
	</script>
</div>

</article>

<div class="copy">
	<? include "inc_html/copy.html"; ?>
</div>

<!-- Modal -->
<form name="submitForm" id="loading" class="modal fade" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" aria-describedby="데이터 업데이트 로딩 바">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<!-- <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> -->
				<h4 class="modal-title" id="myModalLabel">로딩중</h4>
			</div>
			<div class="modal-body">
				<div class="form-group">
					데이터 업데이트 중입니다.
				</div>
				<div style="text-align:center; color:#e06732"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div>
			</div>
		</div>
	</div>
</form>


<script language="javascript" type="text/javascript" src="js/modernizr.js"></script>
</body>
</html>